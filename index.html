
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI í˜‘ì—… ë¦¬ë” ì—­ëŸ‰ ì§„ë‹¨ ì„¤ë¬¸</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // ì†ŒìŠ¤ ì½”ë“œ ë³´í˜¸ ê¸°ëŠ¥
        
        // 1. ìš°í´ë¦­ ë°©ì§€
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
        
        // 2. í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ë°©ì§€ (F12, Ctrl+Shift+I, Ctrl+Shift+C, Ctrl+U ë“±)
        document.addEventListener('keydown', function(e) {
            // F12 ê°œë°œì ë„êµ¬
            if (e.key === 'F12') {
                e.preventDefault();
                return false;
            }
            // Ctrl+Shift+I (ê°œë°œì ë„êµ¬)
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
                return false;
            }
            // Ctrl+Shift+C (ìš”ì†Œ ê²€ì‚¬)
            if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                e.preventDefault();
                return false;
            }
            // Ctrl+Shift+J (ì½˜ì†”)
            if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                e.preventDefault();
                return false;
            }
            // Ctrl+U (ì†ŒìŠ¤ ë³´ê¸°)
            if (e.ctrlKey && e.key === 'u') {
                e.preventDefault();
                return false;
            }
            // Ctrl+S (ì €ì¥)
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                return false;
            }
        });
        
        // 3. í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // 4. ë“œë˜ê·¸ ë°©ì§€
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // 5. ê°œë°œì ë„êµ¬ ê°ì§€ (console ì¶œë ¥)
        setInterval(function() {
            const devtools = /./;
            devtools.toString = function() {
                this.opened = true;
            }
            console.log('%c', devtools);
            if (devtools.opened) {
                console.clear();
                console.log('%cê²½ê³ : ê°œë°œì ë„êµ¬ ì‚¬ìš©ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'color: red; font-size: 20px; font-weight: bold;');
            }
        }, 1000);
        
        // Tailwind JIT í™œì„±í™” ë° ì„¤ì •
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {}
            },
            plugins: [],
        }
    </script>
    <style>
        /* ì‚¬ìš©ì ì„ íƒ ë°©ì§€ */
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Noto Sans KR í°íŠ¸ ì„¤ì • */
        :root {
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        body {
            font-size: 16px;
            line-height: 1.6;
            color: #333;
        }

        /* ì»¤ìŠ¤í…€ ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .rating-input {
            display: none; 
        }
        
        .rating-label {
            min-width: calc(20% - 0.5rem); 
            flex-basis: auto; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: space-between; 
            cursor: pointer; 
            padding: 0.75rem 0.25rem; 
            min-height: 90px; 
            border-radius: 0.75rem; 
            transition: all 0.2s ease-in-out; 
            text-align: center;
            margin: 0.25rem; 
            border: none;
            background-color: transparent;
            box-shadow: none;
        }

        @media (max-width: 640px) {
            .rating-label {
                min-width: calc(50% - 0.5rem); 
                min-height: 80px; 
            }
            .rating-score-text {
                font-size: 0.8rem; 
            }
        }
        @media (max-width: 480px) {
            .rating-label {
                min-width: calc(100% - 0.5rem); 
                min-height: 70px;
            }
            .rating-score-text {
                font-size: 0.9rem;
            }
        }

        .rating-label:hover {
            background-color: transparent; 
            transform: none; 
        }
        .rating-label:hover .rating-score-text {
            color: #64748b;
        }

        .rating-circle {
            width: 1.25rem; 
            height: 1.25rem; 
            border-radius: 9999px; 
            border-width: 2px; 
            border-color: #94a3b8;
            background-color: #ffffff; 
            display: block; 
            margin-bottom: 0.5rem; 
            transition: all 0.15s ease-in-out;
        }

        .rating-score-text {
            font-size: 0.875rem; 
            font-weight: 500; 
            color: #4b5563;
            line-height: 1.3; 
            transition: all 0.15s ease-in-out;
        }
        
        .rating-score-number {
             font-weight: 700; 
             margin-right: 0.15rem;
             color: #4f46e5;
        }

        .rating-input:checked + .rating-label {
            background-color: transparent; 
            transform: none; 
            box-shadow: none;
        }

        .rating-input:checked + .rating-label .rating-circle {
            background-color: #4f46e5;
            border-color: #4f46e5;
            transform: scale(1.1); 
        }

        .rating-input:checked + .rating-label .rating-score-text {
            font-weight: 700; 
            color: #3730a3;
        }
        .rating-input:checked + .rating-label .rating-score-number {
            color: #3730a3;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 sm:p-8">
    <div id="app" class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl p-6 sm:p-10">
        
        <header class="text-center mb-10 border-b pb-6 border-gray-200">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-slate-800 mb-2 leading-tight">
                AI í˜‘ì—… ì›Œí¬í”Œë¡œìš° ë¦¬ë” ì—­ëŸ‰ ì§„ë‹¨
            </h1>
            <p class="text-gray-600 text-lg sm:text-xl">
                êµìœ¡ ì‹œì‘ ì „, ë¦¬ë”ë‹˜ì˜ í˜„ì¬ AI í˜‘ì—… ì¤€ë¹„ ìˆ˜ì¤€ì„ ìê°€ ì§„ë‹¨í•´ ë³´ì„¸ìš”.
            </p>
        </header>

        <form id="assessmentForm">
            <div id="questionsContainer" class="space-y-8"></div>

            <div class="mt-12">
                <div id="statusMessage" class="hidden p-3 mb-4 rounded-lg text-center font-semibold text-sm"></div>

                <button type="submit" id="submitButton"
                    class="w-full bg-slate-700 hover:bg-slate-800 text-white font-bold py-3 sm:py-4 px-4 rounded-lg transition duration-300 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-slate-500 focus:ring-opacity-50 text-lg">
                    ì§„ë‹¨ ê²°ê³¼ í™•ì¸í•˜ê¸°
                </button>
            </div>
        </form>

        <div id="resultsContainer" class="hidden mt-16 pt-8 border-t-4 border-slate-300">
            <h2 class="text-3xl sm:text-4xl font-bold text-slate-700 mb-8 text-center">ì¢…í•© ì§„ë‹¨ ê²°ê³¼</h2>
            
            <div id="scoreSummary" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10"></div>

            <div id="feedbackDetails" class="space-y-8 mt-10"></div>

            <div class="mt-12 text-center space-x-2 sm:space-x-4">
                 <button id="goBackButton"
                    class="bg-slate-700 hover:bg-slate-800 text-white font-bold py-3 px-4 sm:px-6 rounded-lg transition duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-opacity-50 text-base sm:text-lg">
                    ì‘ë‹µ í™•ì¸ ë° ìˆ˜ì •í•˜ê¸°
                </button>
                 <button id="restartButton"
                    class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 sm:px-6 rounded-lg transition duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-opacity-50 text-base sm:text-lg">
                    ì„¤ë¬¸ ë‹¤ì‹œ ì‹œì‘í•˜ê¸°
                </button>
            </div>
            
            <div class="mt-8 text-center text-gray-600 border-t pt-4">
                <p class="font-medium text-sm sm:text-base">ì´ ê²°ê³¼ëŠ” ë¦¬ë”ë‹˜ì˜ êµìœ¡ ì§‘ì¤‘ ì˜ì—­ì„ ì•ˆë‚´í•˜ë©°, ì ˆëŒ€ì ì¸ í‰ê°€ ê¸°ì¤€ì´ ì•„ë‹˜ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <script>
        // ğŸš¨ Google Apps Script 
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwxRkNJnnMVDY4K1IeJNxoVNlVcgqL2P-SDZM7ofncernMu2EBoqCD4NQVFT9AFQPtI/exec'; 
        
        // ì„¤ë¬¸ ë¬¸í•­ ë°ì´í„° ì •ì˜
        const surveyData = [
            {
                id: 'I',
                title: 'I. ë¦¬ë” ê°œì¸ì˜ AI ì´í•´ë„ ë° í™œìš© ìˆ˜ì¤€ (ê°œì¸ ì—­ëŸ‰ ì§„ë‹¨)',
                questions: [
                    "ìš°ë¦¬ íŒ€/ë¶€ì„œì˜ ë¯¸ë˜ ì„±ì¥ì„ ìœ„í•´ AI ê¸°ìˆ ì˜ í™œìš©ì´ í•„ìˆ˜ì ì´ë¼ê³  ìƒê°í•œë‹¤.",
                    "ìƒì„±í˜• AI (ì˜ˆ: ChatGPT)ì˜ ê¸°ë³¸ì ì¸ ì‘ë™ ë°©ì‹ê³¼ ì£¼ìš” ì¥ë‹¨ì ì— ëŒ€í•´ ì–´ëŠ ì •ë„ ì•Œê³  ìˆë‹¤.",
                    "ì—…ë¬´ì™€ ë¬´ê´€í•˜ê²Œ ê°œì¸ì ì¸ í˜¸ê¸°ì‹¬ìœ¼ë¡œ AI ë„êµ¬ (ì˜ˆ: ê¸€ì“°ê¸°, ì´ë¯¸ì§€ ìƒì„± ë“±)ë¥¼ ì‹œë„í•´ ë³¸ ê²½í—˜ì´ ë§ë‹¤.",
                    "ìš°ë¦¬ íŒ€ ì—…ë¬´ì— ì–´ë–¤ AI ë„êµ¬ë¥¼ ì–´ë–»ê²Œ ì ìš©í•´ ë³¼ ìˆ˜ ìˆì„ì§€ êµ¬ì²´ì ìœ¼ë¡œ ê³ ë¯¼í•˜ê³  ìˆë‹¤.",
                    "AI ê¸°ìˆ ì˜ ë°œì „ì— ë§ì¶° ìƒˆë¡œìš´ í™œìš©ë²•ì„ í•™ìŠµí•˜ê³  ìŠµë“í•˜ë ¤ëŠ” ì˜ì§€ê°€ ë†’ë‹¤.",
                    "AI ê¸°ìˆ  ë° íŠ¸ë Œë“œ ë³€í™”ì— ëŒ€í•œ ì •ë³´ë¥¼ ì •ê¸°ì ìœ¼ë¡œ ì°¾ì•„ë³´ë©° íë¦„ì„ ë†“ì¹˜ì§€ ì•Šìœ¼ë ¤ ë…¸ë ¥í•œë‹¤.",
                    "AIë¥¼ ìƒˆë¡œìš´ ê¸°ìˆ ì´ë‚˜ ë„êµ¬ë¼ê¸°ë³´ë‹¤ ì¹œìˆ™í•œ í˜‘ì—… íŒŒíŠ¸ë„ˆë¡œ ë°›ì•„ë“¤ì´ëŠ” ë° ì–´ë ¤ì›€ì´ ì—†ë‹¤."
                ]
            },
            {
                id: 'II',
                title: 'II. íŒ€/ë¶€ì„œ ì—…ë¬´ ë³¸ì§ˆ ë° í”„ë¡œì„¸ìŠ¤ ì¸ì‹ (íŒ€ ì—­ëŸ‰ ì§„ë‹¨)',
                questions: [
                    "ìš°ë¦¬ íŒ€ì˜ í•µì‹¬ ì—…ë¬´ê°€ ì¡°ì§ì— ì œê³µí•˜ëŠ” ê¶ê·¹ì ì¸ ê°€ì¹˜ê°€ ë¬´ì—‡ì¸ì§€ ëª…í™•íˆ ì´í•´í•˜ê³  ìˆë‹¤.",
                    "íŒ€ì˜ í•µì‹¬ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘ë¶€í„° ëê¹Œì§€ ì£¼ìš” ë‹¨ê³„ë³„ë¡œ ë¨¸ë¦¿ì†ì— ëª…í™•íˆ ê·¸ë¦´ ìˆ˜ ìˆë‹¤.",
                    "íŒ€ì˜ ì—…ë¬´ íë¦„ì„ 'ë¡œì§ íŠ¸ë¦¬'ë‚˜ 'í”Œë¡œìš° ì°¨íŠ¸'ì™€ ê°™ì€ ë¶„ì„ ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì²´ê³„ì ìœ¼ë¡œ ë¶„ì„í•´ ë³¸ ê²½í—˜ì´ ë‹¤ìˆ˜ ìˆë‹¤.",
                    "í˜„ì¬ íŒ€ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ì˜ ê° ë‹¨ê³„ì—ì„œ AI í˜‘ì—…ì´ ê°€ëŠ¥í•œ êµ¬ì²´ì ì¸ í¬ì¸íŠ¸ë¥¼ ìƒìƒí•´ ë³¸ ì ì´ ìˆë‹¤.",
                    "íŒ€ì›ë“¤ì˜ ë¹„ê³µì‹ AI ë„êµ¬ ì‚¬ìš©(Shadow AI)ìœ¼ë¡œ ì¸í•œ ì •ë³´ ìœ ì¶œ ë° ë³´ì•ˆ ìœ„í—˜ì„ ì¸ì‹í•˜ê³  ìˆë‹¤.", 
                    "íŒ€ ì—…ë¬´ì— í™œìš©ë˜ëŠ” ë°ì´í„°ê°€ AI ë„êµ¬ê°€ í™œìš©í•˜ê¸° ì¢‹ì€ í˜•íƒœë¡œ ì •ì œë˜ê³  êµ¬ì¡°í™”ë˜ì–´ ìˆë‹¤ê³  ìƒê°í•œë‹¤.",
                    "íŒ€ì›ë“¤ì´ ì—…ë¬´ ì¤‘ AI í™œìš©ì— ëŒ€í•´ ììœ ë¡­ê²Œ ê³µìœ í•˜ê³  í”¼ë“œë°±ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆë„ë¡ ì¥ë ¤í•˜ê³  ìˆë‹¤."
                ]
            },
            {
                id: 'III',
                title: 'III. AI ì‹œëŒ€ ë¦¬ë”ì˜ ì—­í•  ì¬ì •ì˜ ë° ì „ëµ (ë¦¬ë”ì‹­ ë°©í–¥ì„± ì§„ë‹¨)',
                questions: [
                    "AI ë„ì…ì´ ë‹¨ìˆœí•œ íš¨ìœ¨ í–¥ìƒì„ ë„˜ì–´, ìš°ë¦¬ íŒ€ì˜ ì—…ë¬´ ë°©ì‹ ìì²´ë¥¼ ê·¼ë³¸ì ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤ê³  ë¯¿ëŠ”ë‹¤.",
                    "AIê°€ íŒ€ì›ë“¤ì˜ ì—…ë¬´ ì—­í• ê³¼ ì±…ì„ì„ ë³€í™”ì‹œí‚¤ê³  ìƒˆë¡œìš´ ê°€ì¹˜ ì°½ì¶œ ê¸°íšŒë¥¼ ë§Œë“¤ ê²ƒì´ë¼ê³  ì˜ˆìƒí•œë‹¤.",
                    "ìš°ë¦¬ íŒ€ì´ AIë¥¼ í™œìš©í•˜ì—¬ ê°€ì¥ ë¨¼ì € ë³€í™”ì‹œí‚¤ê³  ì‹¶ì€ ì—…ë¬´ ì˜ì—­ì— ëŒ€í•œ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§€ê³  ìˆë‹¤.",
                    "AI ì‹œëŒ€ì— íŒ€ì›ë“¤ì—ê²Œ í•„ìš”í•œ ìƒˆë¡œìš´ í˜‘ì—… ë°©ì‹ì´ë‚˜ ì—­ëŸ‰ (ì˜ˆ: í”„ë¡¬í”„íŠ¸ í™œìš©)ì— ëŒ€í•´ ê³ ë¯¼í•˜ê³  ìˆë‹¤.",
                    "AI í™œìš© ì‹œ ë°ì´í„°ì˜ í¸í–¥ì„±, ê²°ê³¼ì˜ ì±…ì„, ìœ¤ë¦¬ì  ê¸°ì¤€ ë“± ì±…ì„ ìˆëŠ” í™œìš© ì›ì¹™ì„ ê³ ë¯¼í•˜ê³  ìˆë‹¤.", 
                    "AI í™œìš© ì¦ê°€ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì—…ë¬´ ê²°ê³¼ë¬¼ì— ëŒ€í•œ í‰ê°€ ê¸°ì¤€ ë³€í™”ì— ëŒ€í•´ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•  ì¤€ë¹„ê°€ ë˜ì–´ ìˆë‹¤."
                ]
            }
        ];

        // ì ìˆ˜ëŒ€ë³„ ì§„ë‹¨ í•´ì„¤ ë°ì´í„°
        const feedbackData = {
            'I': {
                high: { title: 'âœ¨ AI ì„ ë„ í•™ìŠµì', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> AIì— ëŒ€í•œ ê´€ì‹¬ê³¼ í•™ìŠµ ë™ê¸°ê°€ ë§¤ìš° ë†’ê³ , ê°œì¸ì ì¸ í™œìš© ê²½í—˜ë„ í’ë¶€í•©ë‹ˆë‹¤. ê¸°ìˆ  ë³€í™”ì— ëŒ€í•œ ì‹¬ë¦¬ì  ì¥ë²½ì´ ë‚®ì•„ ìƒˆë¡œìš´ ë„ì „ì„ ì¦ê¸¸ ì¤€ë¹„ê°€ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. \n\nğŸš€ <b>ì„±ì¥ ë°©í–¥:</b> ë¦¬ë”ë‹˜ì˜ ë†’ì€ ê¸°ìˆ  ì´í•´ë„ë¥¼ <b>íŒ€ ë‹¨ìœ„ì˜ ì›Œí¬í”Œë¡œìš° ë¶„ì„</b>ê³¼ <b>ì „ëµì  ì—­í•  ì¬ì •ì˜</b>ë¡œ í™•ì¥í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì‹­ì‹œì˜¤. êµìœ¡ ê³¼ì •ì—ì„œ <b>ì‹¤í–‰ ì „ëµ ìˆ˜ë¦½</b>ì— ê¹Šì´ë¥¼ ë”í•´ íŒ€ì„ ì„ ë„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' },
                mid: { title: 'ğŸ’¡ AI ê´€ì‹¬ í™•ë³´ ë‹¨ê³„', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> AIì˜ í•„ìš”ì„±ì€ ì¸ì‹í•˜ì§€ë§Œ, ê°œì¸ì ì¸ ì‚¬ìš© ê²½í—˜ì´ë‚˜ ì •ë³´ë¥¼ ì ê·¹ì ìœ¼ë¡œ ì°¾ëŠ” ë…¸ë ¥ì€ ë³´í†µ ìˆ˜ì¤€ì…ë‹ˆë‹¤. AIë¥¼ ë„ì…í•´ì•¼ í•œë‹¤ëŠ” ë‹¹ìœ„ì„±ì€ ìˆì§€ë§Œ, ì²«ê±¸ìŒì´ ë§ì„¤ì—¬ì§€ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤. \n\nğŸ’ª <b>ì„±ì¥ ë°©í–¥:</b> AIë¥¼ \'ì•Œì•„ì•¼ í•˜ëŠ” ê²ƒ\'ì—ì„œ \'ì¨ì•¼ í•˜ëŠ” ë„êµ¬\'ë¡œ ì „í™˜í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. êµìœ¡ ì´ˆë°˜ì— ì œì‹œë  ë¦¬ë”ê¸‰ AI í™œìš© ì‚¬ë¡€ë¥¼ í†µí•´ ë™ê¸° ë¶€ì—¬ë¥¼ ì–»ê³  <b>ì ê·¹ì ìœ¼ë¡œ ì‹¤ìŠµ</b>í•˜ì—¬ ê¸°ìˆ  ì¥ë²½ì„ ê·¹ë³µí•˜ëŠ” ê¸°íšŒë¡œ ì‚¼ìœ¼ì‹­ì‹œì˜¤.' },
                low: { title: 'ğŸŒ± AI ê²½í—˜ ì´ˆê¸° ë‹¨ê³„', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> AI ê¸°ìˆ ì— ëŒ€í•œ ë§‰ì—°í•œ ê±°ë¦¬ê°ì´ ìˆê±°ë‚˜, ê°œì¸ì  í™œìš© ë° í•™ìŠµ ì‹œë„ê°€ ë¶€ì¡±í•œ ìƒíƒœì…ë‹ˆë‹¤. AIë¥¼ ì–´ë–»ê²Œ ì‹œì‘í•´ì•¼ í• ì§€, ë¦¬ë”ë¡œì„œ ë¬´ì—‡ë¶€í„° ë°°ì›Œì•¼ í• ì§€ ê³ ë¯¼ì´ ë§ì€ ë‹¨ê³„ì…ë‹ˆë‹¤. \n\nğŸ¯ <b>ì„±ì¥ ë°©í–¥:</b> AIë¥¼ ê²½ìŸìê°€ ì•„ë‹Œ <b>í˜‘ì—… íŒŒíŠ¸ë„ˆ</b>ë¡œ ë°›ì•„ë“¤ì´ëŠ” <b>ì¸ì‹ ì „í™˜</b>ì´ ê°€ì¥ ì‹œê¸‰í•©ë‹ˆë‹¤. êµìœ¡ì˜ <b>1ë‹¨ê³„(AIë¥¼ ì•Œì•„ì•¼ í•˜ëŠ” ì´ìœ )</b>ì— ì§‘ì¤‘í•˜ì—¬, ë¦¬ë”ë¡œì„œ AI í™œìš©ì˜ <b>ë‹¹ìœ„ì„±ê³¼ ì•ˆì „í•œ ì‚¬ìš©ë²•</b>ì„ ë¨¼ì € ìŠµë“í•˜ê³  í•™ìŠµì˜ ê¸°ì´ˆë¥¼ ë‹¤ì§€ë„ë¡ ë…ë ¤í•©ë‹ˆë‹¤.' }
            },
            'II': {
                high: { title: 'ğŸ—ºï¸ í”„ë¡œì„¸ìŠ¤ í†µì°° ë¦¬ë”', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> íŒ€ì˜ í•µì‹¬ ì—…ë¬´ ê°€ì¹˜ì™€ AS-IS í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ëª…í™•í•œ í†µì°°ë ¥ì„ ê°€ì§€ê³  ìˆìœ¼ë©°, Shadow AI ë³´ì•ˆ ìœ„í—˜ ì¸ì‹ ìˆ˜ì¤€ë„ ë†’ìŠµë‹ˆë‹¤. AI ë„ì… ê¸°ë°˜ì´ íƒ„íƒ„í•©ë‹ˆë‹¤. \n\nğŸš€ <b>ì„±ì¥ ë°©í–¥:</b> ì´ë¯¸ ë¶„ì„ ê¸°ë°˜ì´ íƒ„íƒ„í•˜ë¯€ë¡œ, êµìœ¡ì˜ <b>2ë‹¨ê³„(ì›Œí¬í”Œë¡œìš° ë¶„ì„)</b>ë¥¼ í†µí•´ <b>ë‹¨ê³„ë³„ AI í˜‘ì—… ê¸°íšŒ</b>ë¥¼ ë°”ë¡œ êµ¬ì²´í™”í•˜ê³  <b>ê°€ì¥ í° í˜ì‹  íš¨ê³¼</b>ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” í¬ì¸íŠ¸ë¥¼ ë°œêµ´í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì‹­ì‹œì˜¤. ë°œê²¬ëœ ê¸°íšŒë¥¼ ë¹ ë¥´ê²Œ ì‹¤í–‰í•˜ëŠ” ë° ì§‘ì¤‘í•´ ì£¼ì„¸ìš”. ' },
                mid: { title: 'ğŸ“ í”„ë¡œì„¸ìŠ¤ ì§„ë‹¨ ê°•í™” í•„ìš”', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> ì—…ë¬´ëŠ” ì´í•´í•˜ì§€ë§Œ, í”„ë¡œì„¸ìŠ¤ ì§„ë‹¨(ë¡œì§ íŠ¸ë¦¬ ë“±) ê²½í—˜ì´ ë¶€ì¡±í•˜ê³ , Shadow AIë¡œ ì¸í•œ ë³´ì•ˆ ìœ„í—˜ì— ëŒ€í•œ ì¸ì‹ì´ ë³´í†µ ìˆ˜ì¤€ì…ë‹ˆë‹¤. \n\nğŸ’ª <b>ì„±ì¥ ë°©í–¥:</b> êµìœ¡ì˜ <b>2ë‹¨ê³„(ì›Œí¬í”Œë¡œìš° ë¶„ì„)</b>ì—ì„œ ì œì‹œí•˜ëŠ” ì²´ê³„ì ì¸ ë¡œì§ íŠ¸ë¦¬ ë¶„ì„ ë°©ë²•ë¡ ì„ ìŠµë“í•˜ì—¬, ë¨¸ë¦¿ì†ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ <b>ê°ê´€í™”</b>í•˜ê³  <b>AI í˜‘ì—… ê¸°íšŒë¥¼ ì •ëŸ‰ì ìœ¼ë¡œ íƒìƒ‰</b>í•˜ëŠ” ì—­ëŸ‰ì„ ê°•í™”í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì‹­ì‹œì˜¤. AI ë„ì… ì „ ë³´ì•ˆ ë° ë¦¬ìŠ¤í¬ ê´€ë¦¬ë„ í•¨ê»˜ ì ê²€í•´ì•¼ í•©ë‹ˆë‹¤.' },
                low: { title: 'ğŸ§­ ì—…ë¬´ ë³¸ì§ˆ ì¸ì‹ ì¬ì •ë¦½', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> íŒ€ ì—…ë¬´ì˜ í•µì‹¬ ê°€ì¹˜ ì •ì˜ê°€ ëª¨í˜¸í•˜ê³ , ì›Œí¬í”Œë¡œìš° ì§„ë‹¨ ê²½í—˜ì´ ë¶€ì¡±í•˜ë©°, Shadow AIì˜ ìœ„í—˜ì„±ì— ëŒ€í•œ ì¸ì‹ì´ ë‚®ìŠµë‹ˆë‹¤. AI ë„ì… ì´ì „ì— íŒ€ì˜ ê·¼ë³¸ì ì¸ ë¬¸ì œì  íŒŒì•…ê³¼ ë¦¬ìŠ¤í¬ ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. \n\nğŸ¯ <b>ì„±ì¥ ë°©í–¥:</b> êµìœ¡ì˜ <b>2ë‹¨ê³„</b>ì— <b>ê°€ì¥ ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬</b>í•˜ì—¬ <b>AS-IS í”„ë¡œì„¸ìŠ¤ë¥¼ ì¬ì •ì˜</b>í•˜ê³ , ì •ë³´ ë³´ì•ˆ ê´€ì ì—ì„œ AI í™œìš©ì˜ ì•ˆì „ì„±ì„ í™•ë³´í•˜ëŠ” ë°©ë²•ì„ ë°°ìš°ëŠ” ë° ì§‘ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤. í˜ì‹ ì˜ ì²« ë‹¨ì¶”ë¥¼ ë¼ìš°ëŠ” ê³¼ì •ì— ëª°ì…í•´ ì£¼ì„¸ìš”.' }
            },
            'III': {
                high: { title: 'ğŸ‘‘ ë¯¸ë˜ ë³€í™” ì£¼ë„ ë¦¬ë”', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> AIê°€ ê°€ì ¸ì˜¬ ë³€í™”ì˜ íŒŒê¸‰ë ¥ì„ ë¯¿ê³  ìˆìœ¼ë©°, ìœ¤ë¦¬ì  í™œìš© ì›ì¹™ ìˆ˜ë¦½, íŒ€ì›ì˜ ìœ¡ì„±, í‰ê°€ ê¸°ì¤€ ë³€í™”ì— ëŒ€í•œ ì¸ì‹ê³¼ ì˜ì§€ê°€ í™•ê³ í•©ë‹ˆë‹¤. ë³€í™”ë¥¼ ì´ëŒ ì¤€ë¹„ê°€ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. \n\nğŸš€ <b>ì„±ì¥ ë°©í–¥:</b> êµìœ¡ì˜ <b>3, 4ë‹¨ê³„(ì¬ì„¤ê³„ ë° ì—­í•  ì¬ì •ì˜)</b>ë¥¼ í†µí•´ ë¦¬ë”ë‹˜ì˜ ê°•ë ¥í•œ ì˜ì§€ë¥¼ ì‹¤ì§ˆì ì¸ ë³€í™” ê´€ë¦¬ ì „ëµê³¼ ì±…ì„ ìˆëŠ” AI ì‹œëŒ€ íŒ€ ìš´ì˜ ëª¨ë¸ë¡œ ìµœì í™”í•˜ì‹­ì‹œì˜¤. <b>ë¡¤ ëª¨ë¸</b>ë¡œì„œì˜ ì—­í• ì„ ì™„ì„±í•˜ëŠ” ë° ì§‘ì¤‘í•´ ì£¼ì„¸ìš”.' },
                mid: { title: 'ğŸ¤ ì—­í•  ë³€í™” ê³ ë¯¼ ë‹¨ê³„', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> AIì˜ ì˜í–¥ë ¥ì€ ì¸ì§€í•˜ì§€ë§Œ, ìœ¤ë¦¬ì  ì±…ì„, ë°ì´í„° í¸í–¥ì„± ê´€ë¦¬ ë“± ë¦¬ë”ë¡œì„œì˜ ì±…ì„ ìˆëŠ” AI í™œìš© ì›ì¹™ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ê³ ë¯¼ì€ ì§„í–‰ ì¤‘ì¸ ë‹¨ê³„ì…ë‹ˆë‹¤. \n\nğŸ’ª <b>ì„±ì¥ ë°©í–¥:</b> AI ì‹œëŒ€ ë¦¬ë”ì˜ ì—­í• ì€ \'ì´‰ì§„ì/ì§€ì›ì\'ì…ë‹ˆë‹¤. êµìœ¡ì˜ <b>4ë‹¨ê³„(ë¦¬ë”ì˜ ì—­í•  ì¬ì •ì˜)</b>ë¥¼ í†µí•´ ìœ¤ë¦¬ì  AI í™œìš©ì„ ìœ„í•œ ê°€ì´ë“œë¼ì¸ì„ ìˆ˜ë¦½í•˜ê³ , íŒ€ì›ë“¤ì´ <b>AI í™œìš© ê²°ê³¼ì— ëŒ€í•´ ë¹„íŒì ìœ¼ë¡œ íŒë‹¨</b>í•˜ë„ë¡ ì´ëŒ ìˆ˜ ìˆëŠ” ë¦¬ë”ì‹­ ì—­ëŸ‰ì„ í™•ë³´í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì‹­ì‹œì˜¤.' },
                low: { title: 'ğŸ”„ ë¦¬ë”ì‹­ ê´€ì  ì „í™˜ í•„ìˆ˜', message: 'âœ… <b>í˜„ì¬ ìƒíƒœ:</b> AIê°€ ì—…ë¬´ í”„ë¡œì„¸ìŠ¤ ìì²´ë¥¼ ë°”ê¾¼ë‹¤ëŠ” ë¯¿ìŒì´ ì•½í•˜ë©°, AI ìœ¤ë¦¬ì™€ ì±…ì„ì— ëŒ€í•œ ì¸ì‹ì´ ë‚®ì€ ìƒíƒœì…ë‹ˆë‹¤. ìƒˆë¡œìš´ ê¸°ìˆ ì— ëŒ€í•œ ë¦¬ë”ì‹­ ê´€ì  ì „í™˜ì´ í•„ìš”í•©ë‹ˆë‹¤. \n\nğŸ¯ <b>ì„±ì¥ ë°©í–¥:</b> AIëŠ” ë‹¨ìˆœíˆ \'ì—…ë¬´ ê°œì„ \'ì„ ë„˜ì–´ \'ì—…ë¬´ ì¬ì„¤ê³„\'ë¥¼ ìš”êµ¬í•˜ë©°, ì´ëŠ” ìœ¤ë¦¬ì  ì±…ì„ ì—†ì´ëŠ” ì§€ì† ê°€ëŠ¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. êµìœ¡ì˜ <b>3ë‹¨ê³„(ì¬ì„¤ê³„)</b>ì™€ <b>4ë‹¨ê³„(ì—­í•  ì¬ì •ì˜)</b>ì—ì„œ ì œì‹œí•˜ëŠ” AI ì‹œëŒ€ì˜ ìƒˆë¡œìš´ ë¦¬ë”ì‹­ ê´€ì ì„ ë°˜ë“œì‹œ ë‚´ì¬í™”í•˜ê³ , ì±…ì„ê° ìˆëŠ” ë³€í™”ë¥¼ ì£¼ë„í•˜ëŠ” ì²« ê±¸ìŒì„ ë‚´ë”›ëŠ” ë° ì§‘ì¤‘í•´ ì£¼ì„¸ìš”.' }
            }
        };

        // DOM ìš”ì†Œ ì •ì˜
        const questionsContainer = document.getElementById('questionsContainer');
        const assessmentForm = document.getElementById('assessmentForm');
        const resultsContainer = document.getElementById('resultsContainer');
        const scoreSummary = document.getElementById('scoreSummary');
        const feedbackDetails = document.getElementById('feedbackDetails');
        const restartButton = document.getElementById('restartButton');
        const goBackButton = document.getElementById('goBackButton'); 
        const statusMessage = document.getElementById('statusMessage');

        let currentResults = null;
        let userResponses = []; // ì‘ë‹µ ë‚´ìš©ì„ ì €ì¥í•  ë°°ì—´

        // -------------------------------------------------------------------------
        // Google Sheets ì—°ë™ API í˜¸ì¶œ í•¨ìˆ˜
        // -------------------------------------------------------------------------

        // ë ˆë²¨ ë¬¸ìì—´ì„ ë°˜í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜
        function getLevelInfo(average) {
            if (average >= 4.0) {
                return { level: 3, name: "Level 3 (ë³€í™” ì£¼ë„)" };
            } else if (average >= 3.0) {
                return { level: 2, name: "Level 2 (í™œìš© í™•ì¥)" };
            } else {
                return { level: 1, name: "Level 1 (ê¸°ë°˜ ì •ë¦½)" };
            }
        }

        // API ì „ì†¡ìš© í˜ì´ë¡œë“œ ìƒì„±
        function createPayload(results, userResponses) {
            const responsesMap = {};
            userResponses.forEach(res => {
                responsesMap['Q' + res.index] = res.score;
            });

            return {
                responses: responsesMap,
                averages: {
                    I: results.I.average,
                    II: results.II.average,
                    III: results.III.average
                }
            };
        }

        // Google Apps Script API í˜¸ì¶œì„ ì‹œë®¬ë ˆì´ì…˜í•˜ê³  ê²°ê³¼ë¥¼ ì „ì†¡í•˜ëŠ” í•¨ìˆ˜
        async function sendResultsToSheets(results, userResponses) {
            if (APPS_SCRIPT_URL === 'YOUR_DEPLOYED_WEB_APP_URL') {
                statusMessage.classList.remove('hidden', 'bg-emerald-100', 'text-emerald-800');
                statusMessage.classList.add('bg-red-100', 'text-red-800');
                statusMessage.innerHTML = 'ğŸš¨ ì˜¤ë¥˜: Google Apps Script URLì„ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. Sheets ì—°ë™ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.';
                return;
            }

            const payload = createPayload(results, userResponses);
            
            // UIë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ ì „ì†¡ ì¤‘ì„ì„ í‘œì‹œ
            statusMessage.classList.remove('hidden', 'bg-red-100', 'text-red-800', 'bg-emerald-100', 'text-emerald-800');
            statusMessage.classList.add('bg-amber-100', 'text-amber-800');
            statusMessage.innerHTML = '<span class="animate-pulse">ğŸ“</span> ê²°ê³¼ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...';
            document.getElementById('submitButton').disabled = true;

try {
    const response = await fetch(APPS_SCRIPT_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        mode: 'no-cors', // CORS ë¬¸ì œ ë°©ì§€
        body: JSON.stringify(payload)
    });
    
    // mode: 'no-cors' ì‚¬ìš© ì‹œ responseë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ
    // ì„±ê³µí–ˆë‹¤ê³  ê°€ì •í•˜ê³  ì§„í–‰
    statusMessage.classList.remove('bg-amber-100', 'text-amber-800');
    statusMessage.classList.add('bg-emerald-100', 'text-emerald-800');
    statusMessage.innerHTML = `âœ… ì§„ë‹¨ ê²°ê³¼ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.`;
    
    displayResults(results);
    
} catch (error) {
                // ì‹¤íŒ¨ ì‹œ UI ì—…ë°ì´íŠ¸
                statusMessage.classList.remove('bg-amber-100', 'text-amber-800');
                statusMessage.classList.add('bg-red-100', 'text-red-800');
                statusMessage.innerHTML = `âŒ ì‘ë‹µ ì‹¤íŒ¨: ë°ì´í„°ë¥¼ ì „ì†¡í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (ì˜¤ë¥˜: ${error.message})`;
                console.error("Sheets Submission Failed:", error);

            } finally {
                document.getElementById('submitButton').disabled = false;
                // ê²°ê³¼ í‘œì‹œ (ì „ì†¡ ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ì§„ë‹¨ ê²°ê³¼ëŠ” ë³´ì—¬ì¤˜ì•¼ í•¨)
                displayResults(results);
            }
        }
        // -------------------------------------------------------------------------


        // 1. ì„¤ë¬¸ ë¬¸í•­ ë™ì  ìƒì„± í•¨ìˆ˜
        function renderQuestions() {
            let qCounter = 1;
            questionsContainer.innerHTML = ''; // ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”

            const scoreLabels = [
                "ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤",
                "ê·¸ë ‡ì§€ ì•Šë‹¤",
                "ë³´í†µì´ë‹¤",
                "ì•½ê°„ ê·¸ë ‡ë‹¤",
                "ë§¤ìš° ê·¸ë ‡ë‹¤"
            ];

            surveyData.forEach(area => {
                // ì˜ì—­ ì œëª©
                const areaTitleDiv = document.createElement('div');
                areaTitleDiv.className = 'pb-2 mb-4'; 
                areaTitleDiv.innerHTML = `<h2 class="text-xl sm:text-2xl font-semibold text-slate-700">${area.title}</h2>`; // íƒ€ì´í‹€ ìƒ‰ìƒ ë³€ê²½
                questionsContainer.appendChild(areaTitleDiv);

                // ì˜ì—­ë³„ í…Œë‘ë¦¬ ê·¸ë£¹ ì»¨í…Œì´ë„ˆ
                const areaContentDiv = document.createElement('div');
                areaContentDiv.className = 'border border-gray-300 rounded-xl p-4 sm:p-6 mb-6'; 
                questionsContainer.appendChild(areaContentDiv);


                area.questions.forEach((qText, index) => {
                    const qIndex = qCounter++;
                    const questionDiv = document.createElement('div');
                    
                    // ë¬¸í•­ ê°„ ì–‡ì€ íšŒìƒ‰ ì‹¤ì„  êµ¬ë¶„ (ë‘ ë²ˆì§¸ ë¬¸í•­ë¶€í„° ìƒë‹¨ í…Œë‘ë¦¬ ì¶”ê°€)
                    const separatorClass = index > 0 ? 'pt-4 border-t border-gray-200 mt-4' : '';
                    
                    questionDiv.className = `pb-4 ${separatorClass}`; // ê°œë³„ ë¬¸í•­ ìŠ¤íƒ€ì¼: íŒ¨ë”© ë° êµ¬ë¶„ì„ 

                    // ì§ˆë¬¸ í…ìŠ¤íŠ¸
                    questionDiv.innerHTML = `
                        <p class="text-base sm:text-lg font-medium text-gray-800 mb-4 leading-relaxed">
                            <span class="text-slate-700 font-bold mr-2">${qIndex}.</span> ${qText}
                        </p>
                        
                        <div class="flex flex-wrap justify-center sm:justify-between -m-1"> ${[1, 2, 3, 4, 5].map(score => `
                                <input type="radio" id="q${qIndex}-${score}" name="q${qIndex}" value="${score}"
                                    class="rating-input" data-area="${area.id}" data-q-content="${qText}">
                                <label for="q${qIndex}-${score}" class="rating-label">
                                    <span class="rating-circle"></span>
                                    <span class="rating-score-text">
                                        <span class="rating-score-number">${score}.</span>
                                        ${scoreLabels[score - 1]}
                                    </span>
                                </label>
                            `).join('')}
                        </div>
                    `;
                    areaContentDiv.appendChild(questionDiv);
                });
            });
        }

        // 2. ì ìˆ˜ ê³„ì‚° ë° ì§„ë‹¨ ë¡œì§ í•¨ìˆ˜
        function calculateAndDisplayResults(event) {
            event.preventDefault(); // í¼ ì œì¶œ ê¸°ë³¸ ë™ì‘ ë°©ì§€

            const form = event.target;
            let allAnswered = true;
            let scores = { I: [], II: [], III: [] };
            userResponses = []; // ì‘ë‹µ ì €ì¥ ë°°ì—´ ì´ˆê¸°í™”

            // ëª¨ë“  ë¼ë””ì˜¤ ë²„íŠ¼ ì‘ë‹µ ìˆ˜ì§‘
            for (let i = 1; i <= 20; i++) {
                const qName = `q${i}`;
                const checkedInput = form.querySelector(`input[name="${qName}"]:checked`);
                
                if (!checkedInput) {
                    allAnswered = false;
                    // ë¯¸ì‘ë‹µ ë¬¸í•­ì„ ì°¾ì•˜ì„ ë•Œ í•´ë‹¹ ë¬¸í•­ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™ (UX ê°œì„ )
                    const questionElement = document.querySelector(`input[name="${qName}"]`).closest('div[class*="pt-4"]'); // ì§ˆë¬¸ div íƒìƒ‰
                    if(questionElement) {
                        questionElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        // ë¯¸ì‘ë‹µ ë¬¸í•­ì— ì‹œê°ì  ê°•ì¡° íš¨ê³¼ ì¶”ê°€ (ì„ íƒì )
                        questionElement.style.border = '2px solid red';
                        questionElement.style.borderRadius = '0.5rem';
                        setTimeout(() => {
                            questionElement.style.border = '';
                            questionElement.style.borderRadius = '';
                        }, 2000);
                    }
                    break;
                }

                const score = parseInt(checkedInput.value);
                const areaId = checkedInput.getAttribute('data-area');
                const questionContent = checkedInput.getAttribute('data-q-content');
                
                // ì‘ë‹µ ë‚´ìš©ì„ userResponses ë°°ì—´ì— ì €ì¥
                userResponses.push({
                    index: i,
                    area: areaId,
                    content: questionContent,
                    score: score
                });

                scores[areaId].push(score);
            }

            if (!allAnswered) {
                // ë¯¸ì‘ë‹µ ë¬¸í•­ ì•Œë¦¼ íŒì—…
                alert('ë¯¸ì‘ë‹µ ë¬¸í•­ì´ ìˆìŠµë‹ˆë‹¤. ì‘ë‹µë˜ì§€ ì•Šì€ ë¬¸í•­ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.'); 
                return;
            }
            
            let results = {};

            // ì˜ì—­ë³„ í‰ê·  ì ìˆ˜ ê³„ì‚° ë° ì§„ë‹¨
            for (const areaId in scores) {
                const sum = scores[areaId].reduce((acc, val) => acc + val, 0);
                const count = scores[areaId].length;
                const average = count > 0 ? (sum / count) : 0;
                
                const roundedAverage = Math.round(average * 10) / 10;
                
                let feedbackKey;
                if (roundedAverage >= 4.0) {
                    feedbackKey = 'high';
                } else if (roundedAverage >= 3.0) {
                    feedbackKey = 'mid';
                } else {
                    feedbackKey = 'low';
                }

                results[areaId] = {
                    average: roundedAverage.toFixed(1),
                    levelInfo: getLevelInfo(roundedAverage), // ë ˆë²¨ ì •ë³´ ì¶”ê°€
                    feedback: feedbackData[areaId][feedbackKey]
                };
            }

            currentResults = results; // ê²°ê³¼ë¥¼ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥

            // --- Google Sheets API í˜¸ì¶œ ---
            sendResultsToSheets(results, userResponses); 
            // -----------------------------
            
            // ê²°ê³¼ í‘œì‹œëŠ” Sheets ì „ì†¡ ì„±ê³µ/ì‹¤íŒ¨ì™€ ê´€ê³„ì—†ì´ sendResultsToSheets ë‚´ë¶€ì—ì„œ í˜¸ì¶œë¨.
        }

        // 3. ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ (Sheets API í˜¸ì¶œì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œ í˜¸ì¶œë¨)
        function displayResults(results) {
            scoreSummary.innerHTML = '';
            feedbackDetails.innerHTML = '';

            const areaTitles = {
                'I': 'ê°œì¸ AI ì—­ëŸ‰',
                'II': 'íŒ€ ì—…ë¬´ ì¸ì‹',
                'III': 'ë¦¬ë”ì‹­ ë°©í–¥ì„±'
            };
            
            // A. ì ìˆ˜ ìš”ì•½ ì¹´ë“œ ìƒì„± (ë‚¨ìƒ‰/íšŒìƒ‰ í†¤)
            for (const areaId in results) {
                const result = results[areaId];
                const card = document.createElement('div');
                
                // ë ˆë²¨ ìƒ‰ìƒ ì„¤ì •
                let levelColor = 'text-gray-500'; 
                let levelBg = 'bg-gray-100';
                
                if (result.levelInfo.level === 3) {
                    levelColor = 'text-emerald-600'; 
                    levelBg = 'bg-emerald-50';
                } else if (result.levelInfo.level === 2) {
                    levelColor = 'text-amber-600'; 
                    levelBg = 'bg-amber-50';
                } else {
                    levelColor = 'text-rose-600'; 
                    levelBg = 'bg-rose-50';
                }

                // ë‚¨ìƒ‰/íšŒìƒ‰ í†¤ ì ìš©
                card.className = 'bg-white border-4 border-slate-400 rounded-xl shadow-lg p-5 sm:p-6 text-center transition hover:shadow-xl';
                card.innerHTML = `
                    <p class="text-base sm:text-lg font-semibold text-slate-700 mb-2">${areaTitles[areaId]}</p>
                    
                    <div class="mb-4 inline-block px-3 py-1 rounded-full ${levelBg} ${levelColor} font-bold text-sm">
                        ${result.levelInfo.name}
                    </div>

                    <div class="text-4xl sm:text-5xl font-extrabold text-slate-600">${result.average}</div>
                    <p class="mt-2 text-lg sm:text-xl font-bold text-gray-800">${result.feedback.title}</p>
                `;
                scoreSummary.appendChild(card);
            }

            // B. ìƒì„¸ í•´ì„¤ ì„¹ì…˜ ìƒì„± (ì˜…ì€ íšŒìƒ‰ í†¤)
            for (const areaId in results) {
                const result = results[areaId];
                const detailDiv = document.createElement('div');
                
                // ì˜…ì€ íšŒìƒ‰ í†¤ ì ìš©
                const bgColor = 'bg-gray-100'; // ì˜…ì€ íšŒìƒ‰
                const borderColor = 'border-slate-400'; // ë‚¨ìƒ‰ ê³„ì—´ í…Œë‘ë¦¬
                const titleColor = 'text-slate-700'; // ë‚¨ìƒ‰ ê³„ì—´ ì œëª©

                // ë°˜ì‘í˜• íŒ¨ë”© ì¡°ì •
                detailDiv.className = `p-5 sm:p-6 rounded-xl border-l-4 ${borderColor} ${bgColor} shadow-md`;
                detailDiv.innerHTML = `
                    <h3 class="text-xl sm:text-2xl font-extrabold ${titleColor} mb-3">
                        ${areaTitles[areaId]} (í‰ê· : ${result.average}ì , ${result.levelInfo.name})
                    </h3>
                    <h4 class="text-lg sm:text-xl font-bold text-gray-900 mb-3">${result.feedback.title}</h4>
                    <p class="text-sm sm:text-base text-gray-700 leading-relaxed whitespace-pre-wrap">${result.feedback.message}</p>
                `;
                feedbackDetails.appendChild(detailDiv);
            }

            // í¼ ìˆ¨ê¸°ê³  ê²°ê³¼ í‘œì‹œ
            assessmentForm.classList.add('hidden');
            resultsContainer.classList.remove('hidden');

            // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
        }
        
        // 4. ì„¤ë¬¸ ë‹¤ì‹œ ì‹œì‘ í•¨ìˆ˜ (ì¬ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸)
        function restartAssessment() {
            // í¼ í•„ë“œ ì´ˆê¸°í™” (ì‘ë‹µ ë‚´ìš© ì‚­ì œ)
            assessmentForm.reset();
            // API ìƒíƒœ ë©”ì‹œì§€ ì´ˆê¸°í™”
            statusMessage.classList.add('hidden');
            statusMessage.innerHTML = '';
            
            // ê²°ê³¼ ìˆ¨ê¸°ê³  í¼ í‘œì‹œ
            resultsContainer.classList.add('hidden');
            assessmentForm.classList.remove('hidden');
            // í˜ì´ì§€ ìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // 5. ì‘ë‹µ í™•ì¸ ë° ìˆ˜ì • í•¨ìˆ˜ (ëŒì•„ê°€ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸)
        function goBackToSurvey() {
            // í¼ í•„ë“œ ì´ˆê¸°í™”í•˜ì§€ ì•ŠìŒ (ì‘ë‹µ ë‚´ìš© ìœ ì§€)
            // API ìƒíƒœ ë©”ì‹œì§€ ì´ˆê¸°í™”
            statusMessage.classList.add('hidden');
            statusMessage.innerHTML = '';
            
            // ê²°ê³¼ ìˆ¨ê¸°ê³  í¼ í‘œì‹œ
            resultsContainer.classList.add('hidden');
            assessmentForm.classList.remove('hidden');
            // í˜ì´ì§€ ìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        window.onload = () => {
            renderQuestions();
            assessmentForm.addEventListener('submit', calculateAndDisplayResults);
            restartButton.addEventListener('click', restartAssessment); 
            goBackButton.addEventListener('click', goBackToSurvey);
        };
    </script>
</body>
</html>





